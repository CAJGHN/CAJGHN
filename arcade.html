<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>CAJGHN Arade</title>
  <style>
    html,body{height:100%;margin:0;background:#000;color:#fff;font-family:Inter,system-ui,Arial}
    .wrap{display:flex;flex-direction:column;height:100vh}
    header{padding:10px 14px;background:#000;display:flex;align-items:center;gap:12px}
    header h1{font-size:16px;margin:0}
    #game-container{flex:1;display:flex;align-items:center;justify-content:center}
    canvas{background:#111;width:100%;max-width:1100px;height:calc(100vh - 70px);box-shadow:0 10px 30px rgba(0,0,0,0.6);border-radius:8px}
    .hud{position:absolute;right:16px;top:16px;color:#fff;font-size:14px}
  </style>
</head>
<body>
  <div class="wrap">
    <header>
      <h1>CAJGHN Arade</h1>
    </header>

    <div id="game-container">
      <canvas id="game"></canvas>
      <div class="hud" id="hud"></div>
    </div>
  </div>

<script>
const canvas=document.getElementById('game');
const ctx=canvas.getContext('2d');
let W=1000,H=700;
function resize(){
  const ratio=window.devicePixelRatio||1;
  const maxW=Math.min(window.innerWidth-40,1100);
  const maxH=window.innerHeight-120;
  W=Math.max(700,Math.min(maxW,1100));
  H=Math.max(520,Math.min(maxH,800));
  canvas.width=Math.floor(W*ratio);
  canvas.height=Math.floor(H*ratio);
  canvas.style.width=W+'px';
  canvas.style.height=H+'px';
  ctx.setTransform(ratio,0,0,ratio,0,0);
}
window.addEventListener('resize',resize);
resize();
const state={
  keys:{},
  player:{x:W/2,y:H*0.6,vx:0,vy:0,speed:180,hp:5,score:0,alive:true,invincible:3},
  objects:[],
  lastTime:0,
  paused:false,
  started:false
};
function rand(a,b){return Math.random()*(b-a)+a}
function dist(a,b){return Math.hypot(a.x-b.x,a.y-b.y)}
window.addEventListener('keydown',e=>{
  if(!state.started){state.started=true;return;}
  state.keys[e.key.toLowerCase()]=true;
  if(e.key==='r'||e.key==='R') restart();
});
window.addEventListener('keyup',e=>{state.keys[e.key.toLowerCase()]=false;});
function spawnPickup(x,y){state.objects.push({type:'pickup',x,y,r:10,collected:false});}
function spawnEnemy(x,y){state.objects.push({type:'enemy',x,y,w:36,h:48,dir:Math.random()<0.5?-1:1,speed:40+Math.random()*40,vyDir:Math.random()<0.5?-1:1,vySpeed:20+Math.random()*30,hp:1});}
function initMap(){
  state.objects=[];
  for(let i=0;i<10;i++)spawnPickup(rand(80,W-80),rand(120,H-120));
  for(let i=0;i<5;i++)spawnEnemy(rand(80,W-80),rand(120,H-120));
  const p=state.player;
  p.x=W/2;p.y=H*0.6;p.hp=5;p.score=0;p.alive=true;p.invincible=3;
  state.paused=false;
}
initMap();
function restart(){initMap();}
function update(dt){
  if(!state.started||state.paused)return;
  const p=state.player;
  let ax=0,ay=0;
  if(state.keys['arrowleft']||state.keys['a'])ax-=1;
  if(state.keys['arrowright']||state.keys['d'])ax+=1;
  if(state.keys['arrowup']||state.keys['w'])ay-=1;
  if(state.keys['arrowdown']||state.keys['s'])ay+=1;
  const len=Math.hypot(ax,ay)||1;
  p.vx=(ax/len)*p.speed;
  p.vy=(ay/len)*p.speed;
  p.x+=p.vx*dt;p.y+=p.vy*dt;
  p.x=Math.max(40,Math.min(W-40,p.x));
  p.y=Math.max(80,Math.min(H-40,p.y));

  if(p.invincible>0)p.invincible-=dt;

  for(const o of state.objects){
    if(o.type==='enemy'){
      o.x+=o.dir*o.speed*dt;o.y+=o.vyDir*o.vySpeed*dt;
      if(o.x<60||o.x>W-60)o.dir*=-1;
      if(o.y<120||o.y>H-120)o.vyDir*=-1;
      if(dist(p,o)<28+(o.w/2)){
        if(p.invincible<=0 && !o._hitTimer){
          o._hitTimer=0.6;
          p.hp-=1;
          p.invincible=3;
        }
      }
      if(o._hitTimer){o._hitTimer-=dt;if(o._hitTimer<=0)o._hitTimer=0}
    }
  }

  for(const o of state.objects)if(o.type==='pickup'&&!o.collected)
    if(dist(p,o)<30){
      o.collected=true;state.player.score+=10;
      spawnPickup(rand(80,W-80),rand(120,H-120));
      if(state.player.score%100===0)spawnEnemy(rand(80,W-80),rand(120,H-120));
    }

  state.objects=state.objects.filter(o=>{if(o.type==='enemy')return o.hp>0;if(o.type==='pickup')return!o.collected;return true});
  if(p.hp<=0){p.alive=false;p.hp=0;state.paused=true}
}
function render(){
  ctx.clearRect(0,0,W,H);
  ctx.save();ctx.fillStyle='#111';ctx.fillRect(0,0,W,H);ctx.restore();
  if(!state.started){
    ctx.fillStyle='#fff';ctx.font='24px system-ui';ctx.textAlign='center';
    ctx.fillText('Press Any Key to Start',W/2,H/2);
    ctx.textAlign='left';return;
  }
  const drawables=[];
  for(const o of state.objects)drawables.push(o);
  drawables.push({type:'player',x:state.player.x,y:state.player.y});
  drawables.sort((a,b)=>(a.y||0)-(b.y||0));
  for(const obj of drawables){
    if(obj.type==='pickup'){
      ctx.save();const s=1+(obj.y-H*0.4)/(H*0.6)*0.6;ctx.translate(obj.x,obj.y);ctx.scale(s,s);
      ctx.beginPath();ctx.fillStyle='#999';ctx.arc(0,0,10,0,Math.PI*2);ctx.fill();ctx.restore();
    }else if(obj.type==='enemy'){
      const pLike={x:obj.x,y:obj.y};const scale=0.8+(obj.y-H*0.4)/(H*0.6)*0.9;
      ctx.save();ctx.translate(pLike.x,pLike.y);
      ctx.beginPath();ctx.fillStyle='rgba(0,0,0,0.45)';ctx.ellipse(0,18*scale,22*scale,8*scale,0,0,Math.PI*2);ctx.fill();
      ctx.beginPath();ctx.fillStyle='#666';ctx.arc(0,-6*scale,16*scale,0,Math.PI*2);ctx.fill();
      ctx.beginPath();ctx.fillStyle='#666';ctx.arc(0,-6*scale,8*scale,0,Math.PI*2);ctx.fill();
      ctx.fillStyle='#666';ctx.fillRect(-10*scale,6*scale,20*scale,12*scale);ctx.restore();
    }else if(obj.type==='player'){
      const p=state.player;const scale=0.8+(p.y-H*0.4)/(H*0.6)*0.9;
      ctx.save();ctx.translate(p.x,p.y);
      let visible=true;
      if(p.invincible>0)visible=Math.floor(Date.now()/100)%2===0;
      if(visible){
        ctx.beginPath();ctx.fillStyle='rgba(0,0,0,0.45)';ctx.ellipse(0,18*scale,22*scale,8*scale,0,0,Math.PI*2);ctx.fill();
        ctx.beginPath();ctx.fillStyle='#eee';ctx.arc(0,-6*scale,16*scale,0,Math.PI*2);ctx.fill();
        ctx.beginPath();ctx.fillStyle='#eee';ctx.arc(0,-6*scale,8*scale,0,Math.PI*2);ctx.fill();
        ctx.fillStyle='#eee';ctx.fillRect(-10*scale,6*scale,20*scale,12*scale);
      }
      ctx.restore();
    }
  }
  ctx.save();ctx.fillStyle='#fff';ctx.font='14px system-ui';ctx.textAlign='right';
  ctx.fillText(`HP: ${state.player.hp}`,W-24,34);ctx.fillText(`Score: ${state.player.score}`,W-24,56);
  ctx.restore();
  if(state.paused){ctx.fillStyle='#fff';ctx.font='22px system-ui';ctx.textAlign='center';ctx.fillText('GAME OVER',W/2,H/2-5);ctx.font='14px system-ui';ctx.fillText('Press R to Restart',W/2,H/2+20);ctx.textAlign='left'}
}
function loop(timestamp){const dt=(timestamp-state.lastTime)/1000||0.016;state.lastTime=timestamp;update(dt);render();requestAnimationFrame(loop)}
requestAnimationFrame(loop);
const hud=document.getElementById('hud');hud.innerHTML=`Controls: WASD / ←↑→↓ — R to restart`;
</script>
</body>
</html>
