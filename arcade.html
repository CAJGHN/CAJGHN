<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>CAJGHN Arcade</title>
<style>
body { margin:0; background:#000; font-family: Arial, sans-serif; overflow:hidden; }
canvas { display:block; margin:0 auto; background:#111; border:5px solid #555; }
#score { position:absolute; top:10px; left:10px; color:#fff; font-size:36px; font-weight:bold; text-shadow:2px 2px #000; }
#highScore { position:absolute; top:60px; left:10px; color:#fff; font-size:28px; font-weight:bold; text-shadow:2px 2px #000; }
#gameOver { position:absolute; top:50%; left:50%; transform:translate(-50%,-50%); color:#fff; font-size:36px; display:none; text-align:center; text-shadow:2px 2px #000; }
#startBtn, #restartBtn { position:absolute; padding:15px 30px; font-size:24px; border:none; border-radius:10px; cursor:pointer; }
#startBtn { top:50%; left:50%; transform:translate(-50%,-50%); background:#0f0; color:#000; }
#restartBtn { top:60%; left:50%; transform:translate(-50%,-50%); background:#f00; color:#000; display:none; }
.touch-controls { position: fixed; bottom: 10px; left: 50%; transform: translateX(-50%); display: flex; gap: 50px; z-index: 1000; }
.touch-button { width: 80px; height: 80px; background: rgba(255,255,255,0.3); border-radius: 50%; text-align: center; line-height: 80px; font-size: 30px; color: #fff; user-select: none; }
.touch-button:active { background: rgba(255,255,255,0.6); }
</style>
</head>
<body>
<div id="score">Score: 0</div>
<div id="highScore">High Score: 0</div>
<div id="gameOver">Game Over!</div>
<button id="startBtn">START</button>
<button id="restartBtn">RESTART</button>
<canvas id="gameCanvas" width="400" height="600"></canvas>
<div class="touch-controls">
  <div class="touch-button" id="leftBtn">◀</div>
  <div class="touch-button" id="rightBtn">▶</div>
</div>
<script>
const canvas = document.getElementById('gameCanvas');
const ctx = canvas.getContext('2d');

let score = 0;
let highScore = 0;
let gameOver = false;
let gameStarted = false;

let player = { x:180, y:520, size:50, speed:6 };
let fallingBalls = [];
let keys = {};

document.addEventListener('keydown', e => keys[e.key] = true);
document.addEventListener('keyup', e => keys[e.key] = false);

let leftPressed = false;
let rightPressed = false;

const leftBtn = document.getElementById('leftBtn');
const rightBtn = document.getElementById('rightBtn');

[leftBtn,rightBtn].forEach(btn=>{
  btn.addEventListener('touchstart', e=>{ e.preventDefault(); if(btn.id==='leftBtn') leftPressed=true; else rightPressed=true; });
  btn.addEventListener('touchend', e=>{ e.preventDefault(); if(btn.id==='leftBtn') leftPressed=false; else rightPressed=false; });
  btn.addEventListener('mousedown', e=>{ if(btn.id==='leftBtn') leftPressed=true; else rightPressed=true; });
  btn.addEventListener('mouseup', e=>{ if(btn.id==='leftBtn') leftPressed=false; else rightPressed=false; });
  btn.addEventListener('mouseleave', e=>{ if(btn.id==='leftBtn') leftPressed=false; else rightPressed=false; });
});

function spawnBall(){
  const x = Math.random() * (canvas.width - player.size);
  fallingBalls.push({ x, y:-player.size, size:player.size, speed:2 + score*0.05 });
}

function isColliding(a,b){
  const dx = (a.x + a.size/2) - (b.x + b.size/2);
  const dy = (a.y + a.size/2) - (b.y + b.size/2);
  const distance = Math.sqrt(dx*dx + dy*dy);
  return distance < a.size;
}

function resetGame(){
  if(score > highScore) highScore = score;
  score = 0;
  fallingBalls = [];
  player.x = 180;
  gameOver = false;
  document.getElementById('score').innerText = "Score: " + score;
  document.getElementById('highScore').innerText = "High Score: " + highScore;
  document.getElementById('gameOver').style.display = 'none';
  document.getElementById('restartBtn').style.display = 'none';
  gameLoop();
}

function update(){
  if(gameOver || !gameStarted) return;
  if(keys['ArrowLeft'] || leftPressed) if(player.x>0) player.x -= player.speed;
  if(keys['ArrowRight'] || rightPressed) if(player.x+player.size<canvas.width) player.x += player.speed;

  fallingBalls.forEach((b,i)=>{
    b.y += b.speed;
    if(isColliding(player,b)) gameOver = true;
    if(b.y > canvas.height){
      fallingBalls.splice(i,1);
      score +=1;
      document.getElementById('score').innerText = "Score: " + score;
    }
  });

  if(fallingBalls.length < 3 && Math.random() < 0.02) spawnBall();
}

function draw(){
  ctx.clearRect(0,0,canvas.width,canvas.height);
  ctx.fillStyle='#222';
  ctx.fillRect(0,0,canvas.width,canvas.height);
  ctx.strokeStyle='#555';
  ctx.lineWidth = 5;
  ctx.strokeRect(0,0,canvas.width,canvas.height);

  ctx.fillStyle='green';
  ctx.beginPath();
  ctx.arc(player.x+player.size/2, player.y+player.size/2, player.size/2,0,Math.PI*2);
  ctx.fill();

  fallingBalls.forEach(b=>{
    ctx.fillStyle='red';
    ctx.beginPath();
    ctx.arc(b.x+b.size/2, b.y+b.size/2, b.size/2,0,Math.PI*2);
    ctx.fill();
  });
}

function gameLoop(){
  update();
  draw();
  if(!gameOver) requestAnimationFrame(gameLoop);
  else {
    document.getElementById('gameOver').style.display='block';
    document.getElementById('restartBtn').style.display='block';
  }
}

document.getElementById('startBtn').addEventListener('click', ()=>{
  gameStarted=true;
  document.getElementById('startBtn').style.display='none';
  gameLoop();
});

document.getElementById('restartBtn').addEventListener('click', resetGame);
</script>
</body>
</html>
